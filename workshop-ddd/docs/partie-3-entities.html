<!doctype html>
<html lang="en">
	<head>
		<meta charset="utf-8">
		<meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">

		<title>reveal.js</title>

		<link rel="stylesheet" href="dist/reset.css">
		<link rel="stylesheet" href="dist/reveal.css">
		<link rel="stylesheet" href="dist/theme/moon.css">
		<link rel="stylesheet" href="css/customization.css">

		<!-- Theme used for syntax highlighted code -->
		<link rel="stylesheet" href="plugin/highlight/monokai.css">
	</head>
	<body>
		<div class="reveal">
			<div class="slides">
				<section>
					<h1>Domain-Driven Design</h1>
				</section>
				<section>
					<h1>ENTITIES</h1>
				</section>
				<section>
					<h5>Définition</h5>
					<p>
						Représente un concept qui évolue avec le temps
					</p>
				</section>
				<section>
					<h5>Définition</h5>
					<p>
						Possède une identité unique, identifiable dans le système
					</p>
				</section>
				<section>
					<p><span class="highlight">Un utilisateur</span> dans le système d’authentification</p>
					<p><span class="highlight">Un voyage</span> dans le système de planification de voyage</p>								
				</section>
				<section>
					<img class="r-frame" src="./img/part3/entities-value-objects.png" />
				</section>
				<section>
					<h1>REPOSITORIES</h1>
					<aside data-markdown class="notes">
						Memento pattern
						snapshot pattern
					</aside>
				</section>
				<section>
					<h3>Domain Service or Repository ?</h3>
					<pre><code data-trim data-noescape data-line-numbers class="language-javascript">
						class TripPriceCalculator {
							// Repository or Domain Service ?
							private readonly trips: Trips;

							calculate(){
								const monthlyTrips = this.trips.monthlyTrips(userId, date);
							}
						}
					</code></pre>					
				</section>
				<section>
					<h3>It's a detail !</h3>
					<pre><code data-trim data-noescape data-line-numbers class="language-javascript">
						interface Trips {
							add(trip: Trip): void;
							monthlyTrips(userId: string, date: Date): MonthlyTrips;
						}

						class InMemoryTrips implements Trips {
							add(trip: Trip){
								//
							}

							monthlyTrips(userId: string, date: Date): MonthlyTrips {
								// 
							}
						}
					</code></pre>	
				</section>
				<section>
					<h5>Repository</h5>
					<p>
						Se situe dans l’implémentation, pas dans l’utilisation
					</p>
				</section>
				<section>
					<h5>Repository</h5>
					<p>
						Source d’entités ou de value objects
					</p>
				</section>
				<section>
					<h5>Repository</h5>
					<p>
						Destination de sauvegarde (mais pas toujours)
					</p>
				</section>
				<section>
					<h5>Repository</h5>
					<p>
						Un Repository est un Domain Service
					</p>
				</section>
				<section>
					<p><span class="highlight">Collection-Oriented</span> Repository</p>
					<p><span class="highlight">Persistence-Oriented</span> Repository</p>								
				</section>
				<section>					
					<pre><code data-trim data-noescape data-line-numbers class="language-javascript">
						interface Trips {
							add(trip: Trip): void;
							monthlyTrips(userId: string, date: Date): MonthlyTrips;
						}
					</code></pre>	
				</section>
				<section>
					<pre><code data-trim data-noescape data-line-numbers class="language-javascript">
						interface Trips {
							save(trip: Trip): void;
							findMonthlyTrips(userId: string, date: Date): MonthlyTrips;
						}
					</code></pre>
				</section>
				<section>
					<h2>Exercice pratique</h2>
				</section>
				<section>
					<h1>POLICY PATTERN</h1>					
				</section>
				<section>
					<h5>Policy</h5>
					<p>
						Implémente un choix / algorithme variable
					</p>
				</section>
				<section>
					<h5>Policy</h5>
					<p>
						Fait varier le code à exécuter selon des conditions métier
					</p>
				</section>
				<section>
					<pre><code data-trim data-noescape data-line-numbers class="language-javascript">
						interface ItineraryFinder {
							findItinerary(spec: Specification): Itinerary
						}

						class CheapestItineraryFinder implements ItineraryFinder{
							// code ...
						}
						
						class QuickestItineraryFinder implements ItineraryFinder{
							// code ...
						}
						
						class TouristicItineraryFinder implements ItineraryFinder{
							// code ...
						}
					</code></pre>
				</section>
			</div>
		</div>

		<script src="dist/reveal.js"></script>
		<script src="plugin/notes/notes.js"></script>
		<script src="plugin/markdown/markdown.js"></script>
		<script src="plugin/highlight/highlight.js"></script>
		<script>
			// More info about initialization & config:
			// - https://revealjs.com/initialization/
			// - https://revealjs.com/config/
			Reveal.initialize({
				hash: true,

				// Learn about plugins: https://revealjs.com/plugins/
				plugins: [ RevealMarkdown, RevealHighlight, RevealNotes ]
			});
		</script>
	</body>
</html>
